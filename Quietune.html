<!DOCTYPE html>
<html>
<head>
  <title>Quietune</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    input[type=range] {
      width: 300px;
    }
    .control-group {
      margin: 20px;
    }
  </style>
</head>
<body>
  <h1>Quietune</h1>

  <div class="control-group">
    <label for="freq">Frequency (Hz): </label><br>
    <input type="range" id="freq" min="20" max="20000" step="1" value="10000">
    <div id="freqVal">10000 Hz</div>
  </div>

  <div class="control-group">
    <label for="delay">Modulation (microseconds): </label><br>
    <input type="range" id="delay" min="0" max="100" step="0.1" value="0">
    <div id="delayVal">0 µs</div>
  </div>

  <button id="start">Start</button>
  <button id="stop">Stop</button>

  <script>
    let context = new (window.AudioContext || window.webkitAudioContext)();
    let osc1, osc2, delayNode;
    let isPlaying = false;

    const freqSlider = document.getElementById('freq');
    const delaySlider = document.getElementById('delay');
    const freqVal = document.getElementById('freqVal');
    const delayVal = document.getElementById('delayVal');

    function updateFrequency(value) {
      freqVal.innerText = `${value} Hz`;
      if (osc1 && osc2) {
        osc1.frequency.setValueAtTime(value, context.currentTime);
        osc2.frequency.setValueAtTime(value, context.currentTime);
      }
    }

    function updateDelay(value) {
      delayVal.innerText = `${value} µs`;
      if (delayNode) {
        delayNode.delayTime.setValueAtTime(value / 1e6, context.currentTime);
      }
    }

    freqSlider.oninput = (e) => updateFrequency(e.target.value);
    delaySlider.oninput = (e) => updateDelay(e.target.value);

    document.getElementById('start').onclick = () => {
      if (isPlaying) return;
      isPlaying = true;

      const frequency = parseFloat(freqSlider.value);
      const delayMicros = parseFloat(delaySlider.value);

      osc1 = context.createOscillator();
      osc2 = context.createOscillator();
      delayNode = context.createDelay();

      osc1.type = 'sine';
      osc2.type = 'sine';
      osc1.frequency.value = frequency;
      osc2.frequency.value = frequency;
      delayNode.delayTime.value = delayMicros / 1e6;

      osc1.connect(context.destination);
      osc2.connect(delayNode).connect(context.destination);

      osc1.start();
      osc2.start();
    };

    document.getElementById('stop').onclick = () => {
      if (!isPlaying) return;
      osc1.stop();
      osc2.stop();
      isPlaying = false;
    };
  </script>
</body>
</html>